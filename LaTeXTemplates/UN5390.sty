% UN5390.sty
% Do not edit this file under normal circumstances. When you do make changes,
% be sure to inform the instructor as well.

%% Common settings

%
% Packages
\usepackage{etex}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage[small,bf,up]{caption}
\usepackage{chessboard}
\usepackage{colortbl}
\usepackage{enumerate}
\usepackage{epsfig}
\usepackage{fancybox}
\usepackage{fancyhdr}
\usepackage[hang,flushmargin,multiple]{footmisc}
\usepackage{framed}
\usepackage{graphicx}
\usepackage{lastpage}
\usepackage{latexsym}
\usepackage{listings}
\usepackage{longtable}
\usepackage{lscape}
\usepackage{makeidx}
\usepackage{mathabx}
\usepackage{multicol}
\usepackage{multirow}
\usepackage[square,comma,sort&compress,numbers]{natbib}
\usepackage{nextpage}
\usepackage{pgfplots}
\usepackage{rotate}
\usepackage{rotating}
\usepackage{setspace}
\usepackage{skak}
\usepackage[bf]{subfigure}
\usepackage{tabularx}
\usepackage{textcomp}
\usepackage[absolute,overlay]{textpos}
\usepackage{tikz}
\usepackage{titlesec}
\usepackage[nottoc]{tocbibind}
\usepackage[subfigure]{tocloft}
\usepackage{url}
\usepackage{wrapfig}
\usepackage{xcolor}
\usepackage{empheq}
\usepackage[theorems,skins]{tcolorbox}
\usepackage[bookmarks,linktocpage]{hyperref} % This MUST be the LAST package

\usetikzlibrary{arrows,calc,chains,decorations,decorations.fractals,decorations.pathmorphing,decorations.text,fit,fadings,intersections,lindenmayersystems,matrix,mindmap,patterns,plotmarks,positioning,shapes,shadings,shadows,snakes,svg.path,tikzmark,trees}

%
% Page format
\setlength{\oddsidemargin}{0.00in}  % Left side margin
\setlength{\evensidemargin}{0.00in} % Right side margin
\setlength{\topmargin}{-0.50in}     % Top margin
\setlength{\headheight}{0.50in}     % Header height
\setlength{\headsep}{0.35in}        % Separation between header & main text
\setlength{\topskip}{0.00in}        % Top skip
\setlength{\textwidth}{6.50in}      % Width of the text
\setlength{\textheight}{8.50in}     % Height of the text
\setlength{\footskip}{0.50in}       % Foot skip
\setlength{\parindent}{0.00in}      % First line indentation
\setlength{\parskip}{0.15in}        % Space between two paragraphs
\setlength{\columnseprule}{1pt}     % Width of column separator
\setlength{\columnsep}{20pt}        % Separation between columns

%
% Customizing captions (figures, tables, etc.)
\setlength{\floatsep}{0.15in}          % Space left between floats.
\setlength{\textfloatsep}{\floatsep}   % Space between last top float
                                       % or first bottom float and the text
\setlength{\intextsep}{\floatsep}      % Space left on top and bottom
                                       % of an in-text float
\setlength{\abovecaptionskip}{0.10in}  % Space above caption
\setlength{\belowcaptionskip}{0.10in}  % Space below caption
\setlength{\captionmargin}{0.50in}     % Left/Right margin for caption
\setlength{\captionwidth}{5.00in}      % Caption width
\setlength{\abovedisplayskip}{-0.10in} % Space before Math stuff
\setlength{\belowdisplayskip}{-0.10in} % Space after Math stuff
\setlength{\arraycolsep}{0.10in}       % Gap between columns of an array
\setlength{\itemsep}{0.10in}           % Space between successive items

%
% Defining counters
\setcounter{tocdepth}{4}      % Depth of table of contents
\setcounter{lofdepth}{2}      % Depth of list of figures (subfigure)
\setcounter{lotdepth}{2}      % Depth of list of figures (subfigure)
\setcounter{secnumdepth}{5}   % Depth of section numbering
\setcounter{totalnumber}{50}
\setcounter{topnumber}{50}
\setcounter{bottomnumber}{50}

%
% Declaring graphics paths and extensions
% Latex will search in the following directories for graphics files with
% suffixes in the given order. You do not need to specify the graphic file
% extension in the "includegraphics" command.
\graphicspath{{.}{./graphs/}{./images/}}
\DeclareGraphicsExtensions{.eps,.ps,.jpg,.gif,.pdf,.eps.gz,.ps.gz}

%
% Single spaced footnotes
\newcommand{\munfootnote}[1]{%
  \renewcommand{\baselinestretch}{1.25}%
  \footnote{#1}%
  \renewcommand{\baselinestretch}{\lineheight}%
}

%
% Problem environment/counter
\newcounter{problemcounter}
\setcounter{problemcounter}{0}
\newcommand{\problem}{%
  \setcounter{equation}{0}%
  \addtocounter{problemcounter}{1}%
  \section*{\normalsize Problem \arabic{problemcounter}}%
  \vspace*{-0.25in}%
}

%
% Redefined commands and environments
\renewcommand{\baselinestretch}{1.05}
\renewcommand{\thesection}{\arabic{section}}
\renewcommand{\thesubsection}{\arabic{section}.\arabic{subsection}}
\renewcommand{\thesubsubsection}{\arabic{section}.\arabic{subsection}.\arabic{subsubsection}}
\renewcommand{\thefigure}{\arabic{figure}}
\renewcommand{\thetable}{\arabic{table}}
\renewcommand{\theequation}{\arabic{problemcounter}.\arabic{equation}}
\renewcommand{\labelitemi}{$\dag$}
\renewcommand{\headrulewidth}{0.1pt}
\renewcommand{\footrulewidth}{0.1pt}
\renewcommand{\bibname}{References}
\renewcommand\bibsection{\subsection*{\refname}}
\renewcommand\floatpagefraction{.9}
\renewcommand\topfraction{.9}
\renewcommand\bottomfraction{.9}
\renewcommand\textfraction{.1}
\renewcommand{\contentsname}{}
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}

%
% Allow for consistent section/subsection spacing. This Forces LaTeX 
% to keep the same amount of space above and below each title, not 
% using them as flexible space
\titlespacing*{\section}{0cm}{0.5cm}{0.5cm}[0cm]
\titlespacing*{\subsection}{0cm}{0.5cm}{0.5cm}[0cm]
\titlespacing*{\subsubsection}{0cm}{0.5cm}{0.5cm}[0cm]

%
% Bibliography/References
\def\thebibliography#1{
  \list
  {[\arabic{enumi}]}{\settowidth\labelwidth{[#1]}\leftmargin\labelwidth
  \advance\leftmargin\labelsep
  \usecounter{enumi}}
  \def\newblock{\hskip .11em plus .33em minus .07em}
  \sloppy\clubpenalty4000\widowpenalty4000
  \sfcode`\.=1000\relax}

%
% lstlisting options
\lstset{backgroundcolor=\color{white}}
\lstset{rulecolor=\color{blue}}
\lstset{linewidth=\textwidth}
\lstset{commentstyle=\color{blue}} 
\lstset{commentstyle=\texttt}
\lstset{stringstyle=\upshape}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{basicstyle=\ttfamily}
\lstset{stringstyle=\ttfamily}

%
% Retrieve values for different variables
\def\university#1{\gdef\@university{#1}}
\def\department#1{\gdef\@department{#1}}
\def\course#1{\gdef\@course{#1}}
\def\term#1{\gdef\@term{#1}}
\def\studentname#1{\gdef\@studentname{#1}}
\def\studentemail#1{\gdef\@studentemail{#1}}
\def\advisorname#1{\gdef\@advisorname{#1}}
\def\advisoremail#1{\gdef\@advisoremail{#1}}
\def\week#1{\gdef\@week{#1}}
\def\duedate#1{\gdef\@duedate{#1}}
\def\project#1{\gdef\@project{#1}}

% Title section used in project guidelines
\def\projecttitle{%
  \renewcommand{\theequation}{\arabic{equation}}
  \thispagestyle{empty}%

  \vspace*{-0.50in}
  \begin{figure}[htb]
    \begin{center}
      \includegraphics[width=2.34in,height=0.60in]{MichiganTech}
      \label{FIG_MichiganTechLogo}
    \end{center}
  \end{figure}

  \begin{center}
    {\large \textbf{\expandafter{\@course}}}\\
    \vspace{0.05in}
    {\small \expandafter{\@term}}\\
    \vspace{0.25in}
    {\textsf{\expandafter{\@project}}}\\
    \vspace{0.10in}
    {\small \expandafter{\@studentname} (\texttt{\expandafter{\@studentemail})} $\cdot$ \expandafter{\@advisorname} (\texttt{\expandafter{\@advisoremail})}}\\
  \end{center}

  \vspace{0.15in}
  \hrule
  \begin{spacing}{1.50}
    \tableofcontents
  \end{spacing}

  \vspace{0.25in}
  \hrule

  \pagestyle{fancy}
  \fancyhf{}
  \fancyhead[L]{\expandafter{\@studentname}}
  \fancyhead[R]{Page \thepage/\pageref{LastPage}}
  \fancyfoot[C]{\expandafter{\@course}}
  \renewcommand{\baselinestretch}{1.05}
}

%% Settings exclusive to students

%
% Title section used in submitted assignments
\def\assignmenttitle{%
  \thispagestyle{empty}%

  \begin{center}
    {\large \textbf{\expandafter{\@course}}}\\
    {\small \expandafter{\@university}}\\
    {\small \expandafter{\@term}}\\
    \vspace{0.15in}
    {\small Assignment \# \expandafter{\@week}}\\
    {\small \expandafter{\@studentname} (\texttt{\expandafter{\@studentemail})} $\cdot$ \expandafter{\@advisorname} (\texttt{\expandafter{\@advisoremail})}}\\
  \end{center}

  \vspace{0.15in}
  \hrule

  \pagestyle{fancy}
  \fancyhf{}
  \fancyhead[L]{Assignment \# \expandafter{\@week}}
  \fancyhead[R]{Page \thepage/\pageref{LastPage}}
  \fancyfoot[C]{\expandafter{\@course}}
}

% Title section used in review of teaching methods
\def\reviewtitle{%
  \thispagestyle{empty}%

  \begin{center}
    {\large \textbf{\expandafter{\@course}}}\\
    {\small \expandafter{\@university}}\\
    {\small \expandafter{\@term}}\\
    \vspace{0.25in}

    {\large Review of Teaching Methods}\\
    {\small \expandafter{\@studentname} (\texttt{\expandafter{\@studentemail})} $\cdot$ \expandafter{\@advisorname} (\texttt{\expandafter{\@advisoremail})}}\\
  \end{center}

  \vspace{0.15in}
  \hrule

  \pagestyle{fancy}
  \fancyhf{}
  \fancyhead[L]{Assignment \# \expandafter{\@week}}
  \fancyhead[R]{Page \thepage/\pageref{LastPage}}
  \fancyfoot[C]{\expandafter{\@course}}
}

% Title section used in weekly status reports
\def\statustitle{%
  \thispagestyle{empty}%

  \vspace*{-0.50in}
  \begin{figure}[htb]
    \begin{center}
      \includegraphics[width=2.34in,height=0.60in]{MichiganTech}
      \label{FIG_MichiganTechLogo}
    \end{center}
  \end{figure}

  \begin{center}
    {\large \textbf{\expandafter{\@course}}}\\
    {\small \expandafter{\@term}}\\
    \vspace{0.15in}
    Project Status Report (2\% $\times$ 5 weeks)\\
    {\small \expandafter{\@studentname} (\texttt{\expandafter{\@studentemail})} $\cdot$ \expandafter{\@advisorname} (\texttt{\expandafter{\@advisoremail})}}\\
    \vspace{0.15in}
    {\textsf{\expandafter{\@project}}}
  \end{center}

  \vspace{0.05in}
  \hrule

  \pagestyle{fancy}
  \fancyhf{}
  \fancyhead[L]{Project Status Report}
  \fancyhead[R]{Page \thepage/\pageref{LastPage}}
  \fancyfoot[C]{\expandafter{\@course}}
}

%
\pagenumbering{arabic}
